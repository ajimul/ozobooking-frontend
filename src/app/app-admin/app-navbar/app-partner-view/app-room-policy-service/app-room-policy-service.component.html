<main>
    <h2>Residence Room Policy Service Works</h2>
    <form [formGroup]="roomPolicyForm" >
        <div style="display: none;">
            <label for="autoId">Auto Selected Id:
                <span
                    *ngIf="roomPolicyForm.get('roomPolicyRoom_refId')?.invalid && roomPolicyForm.get('roomPolicyRoom_refId')?.touched"
                    class="error-message">
                    {{ getIdError('roomPolicyRoom_refId') }}
                </span>
                <input type="text" id="autoId" formControlName="roomPolicyRoom_refId" readonly >
            </label>

        </div>
        <div id="child-PolicyGroup">
            <label for="policyGroupInput">Enter or Select Amentities Group:
                <span
                    *ngIf="roomPolicyForm.get('roomPolicyName')?.invalid && roomPolicyForm.get('roomPolicyName')?.touched"
                    class="error-message">
                    {{ getTextError('roomPolicyName') }}
                </span>
                <input type="text" id="policyGroupInput" formControlName="roomPolicyName" 
                 [(ngModel)]="roomPolicyName"
                    (focus)="togglePolicyGroup(true)" (keyup)="togglePolicyGroup(false)"
                    (click)="togglePolicyGroupOnClick()">

                <select id="PolicyGroupSelect" #GroupSelect (change)="selectionPolicyGroup(GroupSelect)"
                    [style.display]="isRoomPolicyName ? 'block' : 'none'">
                    <option value="">Select Detail</option>
                    <option *ngFor="let policy of roomPoliciesList" [value]="policy.policy">{{ policy.policy }}</option>

                </select>
            </label>
        </div>
        <div id="child-PolicyDetails">
            <label for="amentitiesDetailsInput">Description:
                <span
                    *ngIf="roomPolicyForm.get('roomPolicyDescription')?.invalid && roomPolicyForm.get('roomPolicyDescription')?.touched"
                    class="error-message">
                    {{ getTextError('roomPolicyDescription') }}
                </span>
                <input type="text" id="amentitiesDetailsInput" formControlName="roomPolicyDescription">
            </label>
        </div>
        <div>
            <button type="button" (click)="addPolicy()">Add Policy</button>
        </div>
    </form>
    <table mat-table matSort [dataSource]="dataSource" class="residence-table">
        <ng-container matColumnDef="roomPolicyName">
            <th mat-header-cell *matHeaderCellDef><strong>Policy-Group </strong></th>
            <td mat-cell *matCellDef="let element; let i = index">
                <input type="text" [(ngModel)]="element.roomPolicyName">
                <div *ngIf="!element.roomPolicyName || element.roomPolicyName.trim().length === 0" class="error-message">Amentities Group is required.</div>


            </td>
        </ng-container>
        <ng-container matColumnDef="roomPolicyDescription">
            <th mat-header-cell *matHeaderCellDef><strong>Policy Details</strong></th>
            <td mat-cell *matCellDef="let element; let i = index">
                <input type="text" [(ngModel)]="element.roomPolicyDescription">
                <div *ngIf="!element.roomPolicyDescription || element.roomPolicyDescription.trim().length === 0" class="error-message">Amentities Details is required.</div>

            </td>
        </ng-container>
        <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef
                style="text-align: center; align-items: center;justify-content: center;"><strong>Actions</strong></th>
            <td mat-cell *matCellDef="let element; let i=index">
                <span class="update-btn" (click)="updatePolicy(element)">Update</span>

                <span class="delete-btn" (click)="deleteAction(element)">Delete</span>
            </td>
        </ng-container>


        <tr mat-header-row *matHeaderRowDef="roomPolicyTableColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: roomPolicyTableColumns;">
        </tr>
    </table>
</main>